<app-navbar
  [email]="this.auth.currentUser.email"
  [firstName]="this.auth.currentUser.firstName"
  [path]="'home'">
</app-navbar>

<!-- ===== WRAPPER ===== -->
<section
  class="min-h-screen w-full overflow-x-hidden
         bg-gradient-to-br from-green-50 via-white to-emerald-100
         dark:from-slate-900 dark:via-slate-800 dark:to-slate-900
         px-4 py-8">

  <!-- ===== HEADER ===== -->
  <header
    class="container mx-auto mb-8 flex flex-col items-center justify-center gap-4
           sm:flex-row">
    <h2
      class="text-center text-lg font-semibold tracking-tight text-gray-800
             dark:text-gray-100 sm:text-2xl">
      Détails de Paiement Carte
    </h2>

    <button
      type="submit"
      routerLink="/client-info-card"
      class="inline-flex items-center gap-2 rounded-full bg-emerald-600 px-4 py-2
             text-xs sm:text-sm font-medium text-white shadow transition
             duration-150 hover:scale-105 hover:bg-emerald-700 focus:outline-none
             focus:ring-4 focus:ring-emerald-300
             dark:bg-emerald-500 dark:hover:bg-emerald-600 dark:focus:ring-emerald-700">
      <svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2"
           viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 5v14m7-7H5" />
      </svg>
      Info Client Carte
    </button>
  </header>

  <!-- ===== CARD LIST ===== -->
  <div
    class="container mx-auto flex justify-center">
    <div
      class="w-full sm:max-w-md
             rounded-2xl bg-white shadow-xl ring-1 ring-gray-200
             dark:bg-slate-800 dark:ring-gray-700">

      <!-- ——— Card header ——— -->
      <div
        class="flex items-center justify-between border-b border-gray-200
               px-4 py-4 dark:border-gray-700">
        <h5
          class="text-base sm:text-lg font-semibold text-gray-800 dark:text-gray-100">
          Paiements
        </h5>

        <!-- Search -->
        <form
          class="flex w-full max-w-[9rem] sm:max-w-[11rem]"
          (submit)="$event.preventDefault()">
          <label class="sr-only">Chercher</label>
          <div class="relative w-full">
            <div
              class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
              <svg class="h-4 w-4 text-gray-500 dark:text-gray-400" fill="none"
                   stroke="currentColor" stroke-width="2"
                   viewBox="0 0 20 20" stroke-linecap="round"
                   stroke-linejoin="round">
                <circle cx="11" cy="11" r="8" />
                <path d="M21 21l-4.35-4.35" />
              </svg>
            </div>
            <input
              id="simple-search" type="text" placeholder="Chercher la date…"
              class="w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 pl-10
                     text-xs sm:text-sm text-gray-900 shadow-sm transition
                     focus:border-emerald-500 focus:ring-emerald-500
                     dark:border-gray-700 dark:bg-gray-700 dark:text-gray-100
                     dark:placeholder-gray-400" />
          </div>
        </form>
      </div>

      <!-- ——— Card body ——— -->
      <ul role="list"
          class="divide-y divide-gray-200 dark:divide-gray-700">
        <li
          *ngFor="let s of payments; let i = index"
          [routerLink]="['/client-portal-card', id]"
          class="group cursor-pointer px-4 py-4 transition-colors duration-150
                 hover:bg-emerald-50 dark:hover:bg-slate-700/60">
          <div class="flex items-center space-x-3">
            <!-- Avatar -->
            <div
              class="relative inline-flex h-9 w-9 flex-shrink-0
                         items-center justify-center overflow-hidden
                         rounded-full bg-emerald-100 text-[10px] sm:text-xs
                         font-semibold text-emerald-700
                         dark:bg-emerald-700 dark:text-emerald-100">
              {{ clientCard.firstName?.substring(0,2) }}
            </div>

            <!-- Name & date -->
            <div class="min-w-0 flex-1">
              <p
                class="whitespace-normal break-words leading-tight
                       text-[11px] sm:text-xs md:text-sm font-medium
                       text-gray-900 dark:text-gray-100">
                {{ clientCard.firstName }} {{ clientCard.lastName }} {{ clientCard.middleName }}
              </p>
              <p
                class="whitespace-normal break-words leading-tight
                       text-[10px] sm:text-xs text-gray-500 dark:text-gray-400">
                {{ formattedPaymentsDates[i] }}
              </p>
            </div>

           <!-- Amount -->
            <div class="whitespace-nowrap text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100">
              FC {{ s | number:'1.0-0' }}
            </div>

            <!-- delete (admins) -->
            <button
              *ngIf="auth.isAdmin"
              (click)="deletePaymentCard(paymentDates[i], $event)"
              aria-label="Supprimer"
              class="ml-3 hidden shrink-0 text-red-600 transition hover:text-red-800
                    focus:outline-none group-hover:inline-block dark:text-red-400
                    dark:hover:text-red-500">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                <line x1="10" y1="11" x2="10" y2="17"/>
                <line x1="14" y1="11" x2="14" y2="17"/>
              </svg>
            </button>

          </div>
        </li>
      </ul>
    </div>
  </div>
</section>
