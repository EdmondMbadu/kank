<app-navbar [email]="this.auth.currentUser.email"[firstName]="this.auth.currentUser.firstName" [path]="'home'" [currentNewClient]="true"></app-navbar>
<div class="flex container mx-auto m-12 justify-center">
    <h1 class="text-2xl text-center md:text-4xl mr-10">Enregistrer Client</h1>
    <button type="submit" class="text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-full text-sm w-auto sm:w-auto px-5 py-2.5 text-center mr-4" routerLink="/info-register">Client Info Enregistrer</button>
</div>

<div class="flex container justify-center mx-auto">

<div class="border-2 shadow border-green-800 p-12 rounded-lg">
    <div class="grid gap-6 mb-6 md:grid-cols-2">
        <div>
            <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900">Nom</label>
            <input type="text" id="first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="" required [(ngModel)]="lastName">
        </div>
        <div>
            <label for="last_name" class="block mb-2 text-sm font-medium text-gray-900 ">Postnom</label>
            <input type="text" id="last_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="" [(ngModel)]="middleName" required>
        </div>   
         
    </div>
    <div class="grid gap-6 mb-6 md:grid-cols-2">
            <div>
                <label for="last_name" class="block mb-2 text-sm font-medium text-gray-900 ">Prenom</label>
                <input type="text" id="last_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="" [(ngModel)]="firstName" required>
            </div>   
           
       
            <div>
                <label for="telelphone" class="block mb-2 text-sm font-medium text-gray-900 ">Telephone</label>
                <input type="tel" id="phone" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="123456789" required pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" [(ngModel)]="phoneNumber">


            </div>

    </div>
    <div class="grid gap-6 mb-6 md:grid-cols-2">
        <div>
            <label for="profession" class="block mb-2 text-sm font-medium text-gray-900">Profession</label>
            <input type="text" id="profession" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="Saleswoman" required [(ngModel)]="profession">
        </div>
        <div>
            <label for="bcapital" class="block mb-2 text-sm font-medium text-gray-900 ">Capital(FC)</label>
            <input type="text" id="bcapital" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="50000" required [(ngModel)]="bussinessCapital">
        </div>   
         
    </div>
    <div class="mb-6">
        <label for="address" class="block mb-2 text-sm font-medium text-gray-900 ">Adresse Domicile</label>
        <input type="text" id="address" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="Kimayala 41 Mont-Ngafula" required [(ngModel)]="homeAddress">
    </div> 
    <div class="mb-6">
        <label for="address" class="block mb-2 text-sm font-medium text-gray-900 ">Addresse Business </label>
        <input type="text" id="baddress" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="Kimayala 41 Mont-Ngafula" required [(ngModel)]="businessAddress">
    </div> 
    <div class="mb-6">
        <label for="applicationFee" class="block mb-2 text-sm font-medium text-gray-900">Depuis combien de temps dirigez-vous votre business ?</label>
        <select id="applicationFee" [(ngModel)]="timeInBusiness"class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  " >
        <option selected>Choose</option>
        <option [ngValue]="0">0 - 1ans</option>
        <option [ngValue]="2">2 - 3 ans</option>
        <option [ngValue]="4">4+ ans</option>
   
        </select>
    </div>
    <div class="mb-6"> 
        <label for="address" class="block mb-2 text-sm font-medium text-gray-900 ">Quel est votre revenu par jour dans votre business (FC)? </label>
        <input type="text" id="income" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="20000" required [(ngModel)]="dailyIncome">
    </div> 
    <div class="mb-6">
        <label for="applicationFee" class="block mb-2 text-sm font-medium text-gray-900">Avez-vous des dettes en cours ?</label>
        <select id="applicationFee" [(ngModel)]="debtInProcess"class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  " >
        <option selected>Choose</option>
        <option [ngValue]="0">Aucune Dettes</option>
        <option [ngValue]="2">1-2 dette</option>
        <option [ngValue]="4">3+ Dettes</option>
   
        </select>
    </div>
    <div class="mb-6">
        <label for="applicationFee" class="block mb-2 text-sm font-medium text-gray-900">Comment comptez-vous gérer le remboursement pendant les périodes difficiles ?</label>
        <select id="applicationFee" [(ngModel)]="planToPayDebt"class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  " >
        <option selected>Choose</option>
        <option [ngValue]="0">Aucun Plan</option>
        <option [ngValue]="2">Plan partiel</option>
        <option [ngValue]="4">Plan Clair</option>
   
        </select>
    </div>
  
    <div class="mb-6">
        <label for="newReferenceName" class="block mb-2 text-sm font-medium text-gray-900">
            Pouvez-vous fournir des références de personnes crédibles?
        </label>
        
        <div *ngFor="let ref of references">
            {{ ref }}
        </div>
    
        <div class="flex items-center gap-2 mb-4">
            <!-- Name Input -->
            <input
                id="newReferenceName"
                type="text"
                [(ngModel)]="newReferenceName"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 w-1/2"
                placeholder="Nom du Référent"
                [disabled]="references.length >= 3"
            />
    
            <!-- Phone Input -->
            <input
                id="newReferencePhone"
                type="tel"
                [(ngModel)]="newReferencePhone"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 w-1/2"
                placeholder="Téléphone (e.g., 0893258653)"
                [disabled]="references.length >= 3"
            />
    
            <!-- Add Button -->
            <button
                (click)="addReference()"
                class="px-4 py-2 bg-green-500 text-white rounded-lg"
                [disabled]="references.length >= 3 || !newReferenceName.trim() || !newReferencePhone.trim()">
                Ajouter
            </button>
        </div>
    </div>
    
    <div class="mb-6">
        <label for="applicationFee" class="block mb-2 text-sm font-medium text-gray-900">Avez-vous des guarantis à offrir aux cas ou vous n'etes pas capable de payer?</label>
        <select id="applicationFee" [(ngModel)]="collateral"class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  " >
        <option selected>Choose</option>
        <option [ngValue]="0">Aucun</option>
        <option [ngValue]="1">Guaranti Partiel</option>
        <option [ngValue]="2">Guaranti Complet</option>
      
        </select>
    </div>
    
    

<div class="mb-6">
    <label for="applicationFee" class="block mb-2 text-sm font-medium text-gray-900">Frais De Dossier</label>
    <select id="applicationFee" [(ngModel)]="applicactionFee"class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  " (change)="displayApplicationFeeOtherAmount()">
    <option selected>Choose</option>
    <option [ngValue]="0">FC 0</option>
    <option [ngValue]="5000">FC 5000</option>
    <option [ngValue]="10000">FC 10,000</option>
    <option [ngValue]="20000">FC 20,000</option>
    <option [ngValue]="30000">FC 30,000</option>
    <option [ngValue]="">Autre Montant </option>
    </select>
</div>

<div *ngIf="applicationFeeOtherDisplay" class="mb-6">
    <label for="savings" class="block mb-2 text-sm font-medium text-gray-900 "> Frais De Dossier Autre Montant</label>
    <input type="text" [(ngModel)]="applicactionFee"id="savings" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="FC20,000" required>
</div> 
<div class="mb-6">
    <label for="memberFee" class="block mb-2 text-sm font-medium text-gray-900">Frais D'Adhesion</label>
    <select id="memberFee" [(ngModel)]="memberShipFee" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  "(change)="displaymemberShipFeeOtherAmount()">
    <option selected>Choose</option>
    <option [ngValue]="0">FC 0</option>
    <option [ngValue]="5000">FC 5000</option>
    <option [ngValue]="10000">FC 10,000</option>
    <option [ngValue]="20000">FC 20,000</option>
    <option [ngValue]="30000">FC 30,000</option>
    <option [ngValue]="">Autre Montant </option>
    </select>
</div>
<div *ngIf="memberShipFeeOtherDisplay" class="mb-6">
    <label for="savings" class="block mb-2 text-sm font-medium text-gray-900 "> Frais D'Adhesion Autre Montant</label>
    <input type="text" [(ngModel)]="memberShipFee"id="savings" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="FC20,000" required>
</div> 
<div class="mb-6">
    <label for="savings" class="block mb-2 text-sm font-medium text-gray-900">Epargnes</label>
    <select id="savings"[(ngModel)]="savings" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  "(change)="displaySavingsOtherAmount()">
        <option [ngValue]="0">FC 0 </option>
        <option [ngValue]="5000">FC 5000</option>
        <option [ngValue]="10000">FC 10,000</option>
        <option [ngValue]="20000">FC 20,000</option>
        <option [ngValue]="30000">FC 30,000</option>
        <option [ngValue]="">Autre Montant </option>
    </select>
</div>
<div *ngIf="savingsOtherDisplay" class="mb-6">
    <label for="savings" class="block mb-2 text-sm font-medium text-gray-900 "> Epargnes Autre Montant</label>
    <input type="text" [(ngModel)]="savings"id="savings" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="FC20,000" required>
</div> 
<div class="mb-6">
    <label for="countries" class="block mb-2 text-sm font-medium text-red-700">Montant Demandé</label>
    <select id="countries"[(ngModel)]="loanAmount"  class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  " (change)="displayLoanOtherAmount()">
    <option selected>Choose</option>
    <option [ngValue]="100000">FC 100,000</option>
    <option [ngValue]="200000">FC 200,000</option>
    <option [ngValue]="300000">FC 300,000</option>
    <option [ngValue]="500000">FC 500,000</option>
    <option [ngValue]="">Autre Montant </option>
    </select>
</div>
<div *ngIf="loanAmountOtherDisplay" class="mb-6">
    <label for="laon" class="block mb-2 text-sm font-medium text-gray-900 "> Montant De Prêt Autre Montant</label>
    <input type="text" [(ngModel)]="loanAmount"id="loanAmount" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="FC20,000" required >
</div> 
<div class="mb-4">
    <label for="start_date" class="block mb-2 text-sm font-medium text-gray-900">Date De Donner L'Argent au Client</label>
    <input [(ngModel)]="requestDate" type="date" id="first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  " placeholder="11-2-2023" required>
  
</div>
<div *ngIf="creditworthinessScore !== null" class="border-2 shadow border-green-800 p-12 rounded-lg">
    <!-- Form inputs here -->

    <!-- Interpretation of Creditworthiness -->
    <div *ngIf="creditworthinessScore !== null" class="mt-3 max-wl-sm">
        <h2 class="text-lg font-bold">Risque Pour Le Crédit</h2>
        <p
            class="text-white p-4 rounded-lg mt-4"
            [ngClass]="{
                'bg-green-600': creditworthinessScore >= 90,
                'bg-blue-500': creditworthinessScore >= 70 && creditworthinessScore < 90,
                'bg-yellow-400': creditworthinessScore >= 50 && creditworthinessScore < 70,
                'bg-red-600': creditworthinessScore < 50
            }"
        >
            <ng-container *ngIf="creditworthinessScore >= 90">
                <strong>Excellent (90-100%) :</strong> Très solvable, prêt sûr.
            </ng-container>
            <ng-container *ngIf="creditworthinessScore >= 70 && creditworthinessScore < 90">
                <strong>Bon (70-89%) :</strong> Solvable avec un risque gérable.
            </ng-container>
            <ng-container *ngIf="creditworthinessScore >= 50 && creditworthinessScore < 70">
                <strong>Moyen (50-69%) :</strong> Risque potentiel ; des vérifications ou des garanties supplémentaires peuvent être nécessaires.
            </ng-container>
            <ng-container *ngIf="creditworthinessScore < 50">
                <strong>Mauvais (moins de 50%) :</strong> Risque élevé ; prêt non conseillé.
            </ng-container>
        </p>
    </div>
  

</div>
  <!-- Display Max Allowed Lending Amount -->
  <div *ngIf="creditworthinessScore !== null" class="border-2 shadow border-blue-600 p-6 rounded-lg mt-6">
    <h2 class="text-lg font-bold text-blue-700">Montant Maximum de Prêt Autorisé</h2>
    <p class="text-gray-900 font-medium text-xl mt-2">
        {{ maxLendAmount| number }} FC
    </p>
</div>


   
<button  class="text-white m-4  bg-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-full text-sm w-auto sm:w-auto px-5 py-2.5 text-center " routerLink="/client-info">Annuler</button>
    <button class="text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-full text-sm w-auto sm:w-auto px-5 py-2.5 text-center "(click)="addNewClient()">Soumettre</button>
</div>


</div>


